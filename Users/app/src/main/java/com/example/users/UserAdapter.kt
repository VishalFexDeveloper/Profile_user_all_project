package com.example.usersimport android.annotation.SuppressLintimport android.app.Activityimport android.content.Contextimport android.content.Intentimport android.view.LayoutInflaterimport android.view.Viewimport android.view.ViewGroupimport android.widget.ImageViewimport android.widget.TextViewimport android.widget.Toastimport androidx.appcompat.app.AlertDialogimport androidx.recyclerview.widget.RecyclerViewimport androidx.recyclerview.widget.RecyclerView.Adapterimport com.example.users.modal.UserModalimport com.google.firebase.firestore.FirebaseFirestoreclass UserAdapter(var user: MutableList<UserModal>, val context: Context):RecyclerView.Adapter<UserAdapter.ViewHolder>() {    inner class ViewHolder(item:View):RecyclerView.ViewHolder(item){        val name = item.findViewById<TextView>(R.id.userdataName)        val number = item.findViewById<TextView>(R.id.userdataNumber)        val email = item.findViewById<TextView>(R.id.userdataEmail)        val deleteBtn = item.findViewById<ImageView>(R.id.deleteBtn)    }    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): UserAdapter.ViewHolder {       val layout = LayoutInflater.from(context).inflate(R.layout.userdata_layout,parent,false)        return ViewHolder(layout)    }    @SuppressLint("SetTextI18n")    override fun onBindViewHolder(holder: UserAdapter.ViewHolder, position: Int) {        holder.email.text = user[position].email        holder.number.text = user[position].number        holder.name.text = "${user[position].name}  (${user[position].city})"        holder.name.setOnClickListener {            val intent = Intent(holder.itemView.context,UpdateActivity::class.java)            intent.putExtra("Id",user[position].id)            holder.itemView.context.startActivity(intent)            (holder.itemView.context as Activity).finish()        }        holder.deleteBtn.setOnClickListener {            user[position].id?.let { it1 -> deleteAlertDialog(it1,position) }        }    }    override fun getItemCount(): Int = user.size    @SuppressLint("NotifyDataSetChanged")    private fun deleteAlertDialog(id:String, position: Int){        val db = FirebaseFirestore.getInstance()        val alertDialog = AlertDialog.Builder(context)        alertDialog.setTitle("USER")            .setMessage("${user[position].name} delete data")            .setNegativeButton("cancel"){ dialog,_ ->                dialog.cancel()            }            .setPositiveButton("delete"){ dialog,_ ->                db.collection("userList").document(id).delete()                    .addOnSuccessListener {                        Toast.makeText(context, "delete Success", Toast.LENGTH_SHORT).show()                        db.collection("userList").get()                            .addOnSuccessListener {documents ->                                val userList = ArrayList<UserModal>()                                for (document in documents) {                                    val user = document.toObject(UserModal::class.java)                                    userList.add(user)                                }                                refreshData(userList)                            }                    }                    .addOnFailureListener {                        Toast.makeText(context, "delete Failure", Toast.LENGTH_SHORT).show()                    }                dialog.dismiss()            }        alertDialog.create()        alertDialog.show()    }    @SuppressLint("NotifyDataSetChanged")    fun refreshData(newUser:List<UserModal>){        user = newUser.toMutableList()        notifyDataSetChanged()    }}